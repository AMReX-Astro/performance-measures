==============================================================================
 Castro Build Information
==============================================================================
build date:    2025-12-11 09:36:26.699336
build machine: Linux nid004143 5.14.21-150500.55.97_13.0.78-cray_shasta_c #1 SMP Thu Mar 13 20:09:44 UTC 2025 (330b47d) x86_64 x86_64 x86_64 GNU/Linux
build dir:     /pscratch/sd/z/zhichen/profile
AMReX dir:     /global/homes/z/zhichen/Github/amrex

COMP:          gnu
COMP version:  13.2.1

C++ compiler:  CC
C++ flags:      -Werror=return-type -g1 -O3 -finline-limit=43210 -pg -std=c++17  -pthread    -DAMREX_TINY_PROFILING -DBL_LAZY -DAMREX_LAZY -DBL_USE_MPI -DAMREX_USE_MPI -DAMREX_MPI_THREAD_MULTIPLE -DBL_NO_FORT -DAMREX_GPU_MAX_THREADS=0 -DBL_SPACEDIM=2 -DAMREX_SPACEDIM=2 -DBL_FORT_USE_UNDERSCORE -DAMREX_FORT_USE_UNDERSCORE -DBL_Linux -DAMREX_Linux -DAMREX_DIMENSION_AGNOSTIC -DNDEBUG -DAMREX_NO_PROBINIT -DSPONGE -DMODEL_PARSER -DNPTS_MODEL=10000 -DNUM_MODELS=2 -DGRAVITY -DREACTIONS -DDIFFUSION -DROTATION -DSTRANG -DNET_LOOP_UNROLL_LEN=4 -DSCREEN_METHOD=SCREEN_METHOD_screen5 -DNEUTRINO_METHOD=NEUTRINO_METHOD_sneut5 -DCONDUCTIVITY -DAUTODIFF_DEVICE_FUNC=AMREX_GPU_HOST_DEVICE -DSCREENING -DNEUTRINOS -DNAUX_NET=0 -Itmp_build_dir/s/2d.gnu.x86-milan.TPROF.MPI.EXE -I. -I/global/homes/z/zhichen/Github/amrex/Src/Base -I/global/homes/z/zhichen/Github/amrex/Src/Base/Parser -I/global/homes/z/zhichen/Github/amrex/Src/AmrCore -I/global/homes/z/zhichen/Github/amrex/Src/Amr -I/global/homes/z/zhichen/Github/amrex/Src/Boundary -I/global/homes/z/zhichen/Github/amrex/Src/LinearSolvers/MLMG -I/global/homes/z/zhichen/Github/Microphysics/util -I/global/homes/z/zhichen/Github/Microphysics/util/autodiff -I/global/homes/z/zhichen/Github/Microphysics/util/gcem/include -I/global/homes/z/zhichen/Github/Microphysics/integration/RKC -I/global/homes/z/zhichen/Github/Microphysics/integration/utils -I/global/homes/z/zhichen/Github/Microphysics/integration -I/global/homes/z/zhichen/Github/Microphysics/screening -I/global/homes/z/zhichen/Github/Microphysics/neutrinos -I./ -I/global/homes/z/zhichen/Github/Castro/Source/driver -I/global/homes/z/zhichen/Github/Castro/Source/hydro -I/global/homes/z/zhichen/Github/Castro/Source/problems -I/global/homes/z/zhichen/Github/Castro/Source/sources -I/global/homes/z/zhichen/Github/Castro/Util/model_parser -I/global/homes/z/zhichen/Github/Castro/Source/gravity -I/global/homes/z/zhichen/Github/Castro/Source/scf -I/global/homes/z/zhichen/Github/Castro/Source/reactions -I/global/homes/z/zhichen/Github/Castro/Source/diffusion -I/global/homes/z/zhichen/Github/Castro/Source/rotation -I/global/homes/z/zhichen/Github/Microphysics/EOS -I/global/homes/z/zhichen/Github/Microphysics/EOS/helmholtz -I/global/homes/z/zhichen/Github/Microphysics/networks/he-burn/cno-he-burn-33a -I/global/homes/z/zhichen/Github/Microphysics/EOS -I/global/homes/z/zhichen/Github/Microphysics/networks -I/global/homes/z/zhichen/Github/Microphysics/interfaces -I/global/homes/z/zhichen/Github/Microphysics/conductivity -I/global/homes/z/zhichen/Github/Microphysics/conductivity/stellar -I/global/homes/z/zhichen/Github/Microphysics/constants -I/global/homes/z/zhichen/Github/Microphysics/util/approx_math -Itmp_build_dir/castro_sources/2d.gnu.x86-milan.TPROF.MPI.EXE -I/global/homes/z/zhichen/Github/amrex/Tools/C_scripts  -I/opt/cray/pe/mpich/8.1.30/ofi/gnu/12.3/include -I/opt/cray/pe/libsci/24.07.0/GNU/12.3/x86_64/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/24.5/cuda/12.4/nvvm/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/24.5/cuda/12.4/extras/CUPTI/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/24.5/cuda/12.4/extras/Debugger/include -I/opt/cray/pe/dsmml/0.3.0/dsmml//include

Fortran comp:  ftn
Fortran flags:  -g1 -O3 -pg -ffree-line-length-none -fno-range-check -fno-second-underscore -fimplicit-none 

Link flags:    -L. 
Libraries:      -lmpichf90 

EOS: /global/homes/z/zhichen/Github/Microphysics/EOS/helmholtz
NETWORK: /global/homes/z/zhichen/Github/Microphysics/networks/he-burn/cno-he-burn-33a
CONDUCTIVITY: /global/homes/z/zhichen/Github/Microphysics/conductivity/stellar
INTEGRATOR: RKC
SCREENING: screen5

Castro       git describe: 25.12
AMReX        git describe: 23.02-1153-gc23d2e158
Microphysics git describe: 24.04-307-ge60af54c


TinyProfiler total time across processes [min...avg...max]: 1038.9283 ... 1038.9363 ... 1038.9484

-------------------------------------------------------------------------------------------
Name                                        NCalls  Excl. Min  Excl. Avg  Excl. Max   Max %
-------------------------------------------------------------------------------------------
Castro::react_state()                          260   744.3947   747.3633   750.0595  72.19%
Amr::InitAmr()                                   1      58.84      58.87      58.89   5.67%
FabArray::ParallelCopy_finish()               8270      29.78      38.38      54.53   5.25%
Castro::construct_ctu_hydro_source()           130      33.71      38.55      44.52   4.29%
Castro::normalize_species()                   1334      25.16      30.27      35.86   3.45%
Castro::estTimeStep()                          275      28.94       31.7      34.21   3.29%
Castro::computeTemp()                         1334      22.35      26.47      30.19   2.91%
Castro::reset_internal_energy(Fab)            3573      12.26      16.74       20.6   1.98%
Castro::getTempDiffusionTerm()                 590      10.35      16.63      20.44   1.97%
check_for_negative_density()                   130      5.623      11.63      16.76   1.61%
FillBoundary_finish()                          320     0.4506      2.178      5.694   0.55%
FabArray::ParallelCopy_nowait()               5787       2.79      3.767      5.012   0.48%
Castro::construct_new_rotation_source()        230      1.299      2.753       3.74   0.36%
amrex::Copy()                                 4197      1.912      2.775      3.627   0.35%
Castro::construct_new_gravity_source()         230      1.191      2.284      3.367   0.32%
FabArray::setVal()                            4579     0.9595      1.261      1.516   0.15%
FillPatchInterp(MF)                           1229   0.001503      0.294      1.102   0.11%
AmrLevel::derive()                             324     0.4573     0.6068     0.7819   0.08%
Castro::construct_old_rotation_source()        130      0.231     0.5692      0.778   0.07%
Castro::construct_old_gravity_source()         130     0.2313     0.4934     0.7082   0.07%
Castro::sum_integrated_quantities()             10     0.3866     0.5384     0.6827   0.07%
FluxRegister::Reflux()                         400    0.08262     0.3214     0.5521   0.05%
FillPatchSingleLevel                          3403     0.2207     0.3522     0.5427   0.05%
Castro::construct_new_source()                1610     0.2893     0.3533     0.4719   0.05%
Castro::reflux()                                50     0.2038     0.2887     0.3746   0.04%
amrex::average_down_w_geom                     250      0.222     0.2878     0.3548   0.03%
Amr::writePlotFile()                             1    0.04996     0.1465      0.207   0.02%
Castro::construct_old_source()                 910    0.06954    0.08917     0.1077   0.01%
FillPatchTwoLevels                            1671     0.0219    0.02862    0.04007   0.00%
FillPatchIterator::Initialize                 2174    0.01495    0.02053    0.03536   0.00%
AmrLevel::FillPatch()                         1584    0.01136     0.0178     0.0331   0.00%
Amr::regrid()                                   20   0.006288    0.01205     0.0216   0.00%
Amr::coarseTimeStep()                           10    0.01485    0.01796    0.01829   0.00%
Castro::finalize_do_advance()                  130   0.001707   0.002601    0.01447   0.00%
Castro::subcycle_advance_ctu()                 130   0.001128    0.00218    0.01185   0.00%
Castro::reset_internal_energy(MultiFab)       1334   0.008221   0.009433      0.011   0.00%
Amr::timeStep()                                130   0.004604   0.006659    0.01091   0.00%
FabArray::ParallelCopy()                      5787   0.007216   0.007954   0.009082   0.00%
Castro::clean_state()                         1334   0.005486   0.006312   0.007122   0.00%
main()                                           1   0.001925   0.003665   0.007074   0.00%
Castro::initialize_advance()                   130   0.003784   0.004376   0.006476   0.00%
FillPatchIterator::FillFromTwoLevels()        1671   0.004498   0.005221   0.005854   0.00%
Castro::construct_old_diff_source()            130    0.00279   0.004399   0.005665   0.00%
Castro::initialize_do_advance()                130    0.00273   0.003728   0.005267   0.00%
Castro::do_advance_ctu()                       130   0.003226    0.00426   0.005071   0.00%
Castro::construct_new_diff_source()            230    0.00241    0.00296   0.003568   0.00%
Castro::do_old_sources()                       130   0.001323   0.002005   0.002537   0.00%
Castro::add_temp_diffusion_to_sources()        590   0.001707   0.002116   0.002505   0.00%
Castro::do_new_sources()                       230   0.001732   0.001951   0.002153   0.00%
Castro::advance()                              130  0.0008544   0.001232    0.00203   0.00%
Castro::post_timestep()                        130  0.0003823  0.0005387  0.0008227   0.00%
FillPatchIterator::FillFromLevel0()            503  0.0005487  0.0006355  0.0007552   0.00%
Castro::expand_state()                         180  0.0004809  0.0005767  0.0006707   0.00%
Castro::avgDown(state_indx)                    250  0.0003059  0.0004372  0.0005896   0.00%
FabArray::FillBoundary()                       320  0.0003926  0.0004551  0.0005737   0.00%
Castro::derive()                               324  0.0002762  0.0003745  0.0005472   0.00%
Castro::init(old)                               25  0.0003471  0.0004047  0.0004895   0.00%
Castro::post_regrid()                           60   0.000176  0.0002256  0.0002929   0.00%
Castro::avgDown()                               50  0.0001256  0.0001821  0.0002403   0.00%
Castro::computeNewDt()                          15  7.705e-05  9.766e-05  0.0001296   0.00%
Other                                        28638      1.801      2.808      4.107   0.40%
-------------------------------------------------------------------------------------------

-------------------------------------------------------------------------------------------
Name                                        NCalls  Incl. Min  Incl. Avg  Incl. Max   Max %
-------------------------------------------------------------------------------------------
main()                                           1       1039       1039       1039 100.00%
Amr::coarseTimeStep()                           10      977.8      977.8      977.8  94.12%
Amr::timeStep()                                130        976        976        976  93.94%
Castro::advance()                              130      924.7      926.1      927.6  89.28%
Castro::subcycle_advance_ctu()                 130      914.2      916.9        920  88.55%
Castro::do_advance_ctu()                       130      914.2      916.9        920  88.55%
Castro::react_state()                          260      744.4      747.4      750.1  72.20%
Castro::clean_state()                         1334       59.9       73.6      85.59   8.24%
Castro::construct_ctu_hydro_source()           130       56.9      59.57      61.53   5.92%
FabArray::ParallelCopy()                      5787       33.8      42.71      60.11   5.79%
Amr::InitAmr()                                   1      58.84      58.87      58.89   5.67%
FillPatchIterator::Initialize                 2174      30.69       40.8      55.03   5.30%
FabArray::ParallelCopy_finish()               8270      29.78      38.38      54.53   5.25%
Castro::do_new_sources()                       230      49.45      50.77      53.12   5.11%
FillPatchIterator::FillFromTwoLevels()        1671      27.42      37.88      52.08   5.01%
FillPatchTwoLevels                            1671      27.41      37.87      52.07   5.01%
Castro::computeTemp()                         1334      34.62      43.21      49.61   4.78%
FillPatchSingleLevel                          3403      13.39      30.84      45.02   4.33%
Castro::post_timestep()                        130      42.75      43.83      44.82   4.31%
Castro::add_temp_diffusion_to_sources()        590      34.79      39.24         44   4.23%
Castro::getTempDiffusionTerm()                 590      34.76      39.19      43.95   4.23%
Castro::construct_new_source()                1610      34.47      37.17       39.6   3.81%
AmrLevel::FillPatch()                         1584      18.38      25.01      36.11   3.48%
Castro::normalize_species()                   1334      25.16      30.27      35.86   3.45%
Castro::construct_new_diff_source()            230      27.25      31.67      35.69   3.44%
Castro::estTimeStep()                          275      28.94       31.7      34.21   3.29%
FabArray::ParallelCopy_nowait()               5787      16.98      25.28      33.51   3.23%
Castro::reflux()                                50      29.43      31.51      33.45   3.22%
Castro::initialize_do_advance()                130      24.31      26.82      30.11   2.90%
Castro::do_old_sources()                       130      21.08      23.06      24.68   2.38%
Castro::reset_internal_energy(MultiFab)       1334      12.27      16.75      20.61   1.98%
Castro::reset_internal_energy(Fab)            3573      12.26      16.74       20.6   1.98%
Castro::finalize_do_advance()                  130      16.05      17.49      19.29   1.86%
Castro::expand_state()                         180      9.987      13.43      18.13   1.75%
check_for_negative_density()                   130      5.623      11.63      16.76   1.61%
Castro::construct_old_source()                 910      7.595        8.8      10.12   0.97%
Castro::initialize_advance()                   130      6.984      8.632      10.04   0.97%
Castro::construct_old_diff_source()            130       6.47       7.58      8.952   0.86%
FillPatchIterator::FillFromLevel0()            503     0.9249      2.868      7.023   0.68%
FabArray::FillBoundary()                       320     0.4585      2.184      5.702   0.55%
FillBoundary_finish()                          320     0.4506      2.178      5.694   0.55%
Amr::regrid()                                   20      4.305      4.877      5.453   0.52%
Castro::avgDown()                               50      1.625       3.52      5.167   0.50%
Castro::avgDown(state_indx)                    250      1.625      3.519      5.167   0.50%
amrex::average_down_w_geom                     250      1.624      3.519      5.167   0.50%
Castro::post_regrid()                           60      2.373      3.169      3.978   0.38%
Castro::construct_new_rotation_source()        230      1.299      2.753       3.74   0.36%
amrex::Copy()                                 4197      1.912      2.775      3.627   0.35%
Castro::construct_new_gravity_source()         230      1.191      2.284      3.367   0.32%
Castro::computeNewDt()                          15      2.852      3.048      3.176   0.31%
Amr::writePlotFile()                             1      1.644      1.644      1.644   0.16%
FabArray::setVal()                            4579     0.9595      1.261      1.516   0.15%
Castro::derive()                               324      1.188      1.294      1.413   0.14%
AmrLevel::derive()                             324      1.188      1.294      1.413   0.14%
FluxRegister::Reflux()                         400      0.877       1.04      1.166   0.11%
FillPatchInterp(MF)                           1229   0.001503      0.294      1.102   0.11%
Castro::init(old)                               25     0.8465     0.9221     0.9848   0.09%
Castro::construct_old_rotation_source()        130      0.231     0.5692      0.778   0.07%
Castro::sum_integrated_quantities()             10     0.4638     0.6209     0.7578   0.07%
Castro::construct_old_gravity_source()         130     0.2313     0.4934     0.7082   0.07%
Other                                        28638      5.149      7.366       9.87   0.95%
-------------------------------------------------------------------------------------------

Async Memory Usage:
--------------------------------------------------------------------------------------------------------------------
Name                                  Nalloc  AvgMem min  AvgMem avg  AvgMem max  MaxMem min  MaxMem avg  MaxMem max
--------------------------------------------------------------------------------------------------------------------
Castro::construct_ctu_hydro_source()  376400     180 KiB     238 KiB     292 KiB    5085 KiB    7213 KiB    8049 KiB
AmrLevel::derive()                       692       2   B       5   B       9   B      83 KiB     117 KiB     132 KiB
--------------------------------------------------------------------------------------------------------------------

Pinned Memory Usage:
--------------------------------------------------------------------------------------------------------------
Name                            Nalloc  AvgMem min  AvgMem avg  AvgMem max  MaxMem min  MaxMem avg  MaxMem max
--------------------------------------------------------------------------------------------------------------
The_Pinned_Arena::Initialize()     110       0   B       0   B       2   B    8192 KiB    8192 KiB    8192 KiB
--------------------------------------------------------------------------------------------------------------

Cpu Memory Usage:
---------------------------------------------------------------------------------------------------------------------
Name                                   Nalloc  AvgMem min  AvgMem avg  AvgMem max  MaxMem min  MaxMem avg  MaxMem max
---------------------------------------------------------------------------------------------------------------------
Castro::initMFs()                      147978      51 MiB      57 MiB      63 MiB      90 MiB     104 MiB     117 MiB
StateData::define()                     46250      20 MiB      22 MiB      25 MiB      36 MiB      42 MiB      48 MiB
Amr::writePlotFile()                      692      35 KiB      42 KiB      48 KiB      30 MiB      38 MiB      44 MiB
StateData::restartDoit()                 3460     839 KiB    2012 KiB    3301 KiB      23 MiB      25 MiB      28 MiB
Castro::swap_state_time_levels()        46970      20 MiB      22 MiB      24 MiB      23 MiB      25 MiB      28 MiB
Castro::reflux()                        30000      22 KiB      36 KiB      57 KiB    8051 KiB      12 MiB      19 MiB
FillPatchIterator::Initialize          513486     446 KiB     545 KiB     631 KiB      12 MiB      16 MiB      19 MiB
Castro::initialize_do_advance()         40720      10 MiB      12 MiB      14 MiB      12 MiB      16 MiB      19 MiB
AmrLevel::derive()                     150164    9575   B      11 KiB      14 KiB      12 MiB      14 MiB      17 MiB
Castro::construct_ctu_hydro_source()   376400     180 KiB     238 KiB     292 KiB    5085 KiB    7213 KiB    8049 KiB
Castro::buildMetrics()                  59652    2868 KiB    3218 KiB    3565 KiB    4990 KiB    5835 KiB    6668 KiB
Castro::FluxRegCrseInit                 36000    1147   B    1781   B    2742   B    2665 KiB    4246 KiB    6642 KiB
FluxRegister::Reflux()                  48000    2425   B    3798   B    5827   B    2600 KiB    4143 KiB    6480 KiB
FillPatchSingleLevel                   103680     583   B      17 KiB      44 KiB    2560 KiB    4101 KiB    6400 KiB
FabArray::ParallelCopy_nowait()       1209627    6545   B      14 KiB      26 KiB    2300 KiB    4457 KiB    5600 KiB
amrex::average_down_w_geom             185000    2771   B       9 KiB      17 KiB    3168 KiB    3922 KiB    4576 KiB
Castro::initialize_advance()            40720    1800 KiB    2175 KiB    2555 KiB    2242 KiB    2786 KiB    3312 KiB
Castro::construct_old_source()          40720     161   B     351   B     500   B    2016 KiB    2496 KiB    2912 KiB
Castro::construct_new_source()          65220     532   B     830   B    1166   B    2016 KiB    2496 KiB    2912 KiB
Amr::writeSmallPlotFile()                 692     138   B     171   B     212   B    2016 KiB    2496 KiB    2912 KiB
Castro::getTempDiffusionTerm()         664980      29 KiB      34 KiB      38 KiB    1011 KiB    1209 KiB    1391 KiB
Gravity::get_new_grav_vector()          40720       6   B      10   B      16   B     640 KiB     796 KiB     946 KiB
Gravity::get_old_grav_vector()          40720      35   B      65   B      91   B     640 KiB     796 KiB     946 KiB
Castro::construct_old_diff_source()     40720    1912   B    2363   B    2746   B     288 KiB     356 KiB     416 KiB
Castro::construct_new_diff_source()     65220    6960   B    8504   B    9686   B     288 KiB     356 KiB     416 KiB
FillPatchTwoLevels                      87180       0   B    1538   B    5542   B       0   B     205 KiB     395 KiB
Castro::build_fine_mask()                2580     568   B     679   B     933   B     120 KiB     141 KiB     192 KiB
FillPatchInterp(MF)                     43590       0   B      24   B     127   B       0   B      68 KiB     157 KiB
AmrMesh::MakeNewGrids()                  6000       0   B       2   B       5   B    9572   B      14 KiB      21 KiB
FillBoundary_nowait()                   70400       2   B      11   B      34   B    3600   B    6193   B    9248   B
OwnerMask()                              3000       0   B       0   B       0   B    1296   B    1619   B    2736   B
TagBoxArray::mapPRD                      3000       0   B       0   B       0   B     324   B     404   B     684   B
---------------------------------------------------------------------------------------------------------------------